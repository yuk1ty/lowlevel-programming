## Q47: さまざまなページ置換法について学んでおこう。他にどのような方法があるだろうか？

- FIFO: プロセスに割り当てたページを割り当てた順番にキューに乗せる。ページ置換が必要になったとき、キューの先頭のページ（最も古いページ）を選択する。
- セカンドチャンス: FIFO を少し改良したもの。FIFO の先頭ページをまず調べるが、即座にスワップアウトするのではなく、参照ビットが立っているかどうかを調べる。もしなければスワップアウトする。立っていれば、そのページの参照ビットをクリアして FIFO の最後尾につなぎ直す。
- クロック: クロック（時計）とは、FIFO をセカンドチャンスよりも効率化した方式で、ページを定期的にリストの後方に押しやる必要がなく、セカンドチャンスと同等の機能を実現するものである。クロックアルゴリズムではページを円環状のリストとして扱い、そのリスト上の最も古いページを指す「針」を使用する。ページフォールトが発生して空きがないとき、針が指している位置から参照ビットのチェックを行う。参照ビットが 0 なら、針の指しているページを再利用し、0 でないなら参照ビットをクリアして針をインクリメントする。そして、置換可能なページが見つかるまでこれを繰り返す。
- エージング: NFU を改良したアルゴリズムで、ページを使用した時間間隔を考慮するようにしたもの。ページごとのカウンタを単純にインクリメントするかわりに、時間に応じて参照に重み付けをする。最近の参照に対応した値は大きくなり、過去に遡るほど値は小さくなる。これによって、最近の参照されたページが優先されるようになる。

この資料がよかった。横向きだけど。
http://web-ext.u-aizu.ac.jp/course/osrtk/lecture/pdffordisplay/4-4-5.pdf

## Q48: 4 番目のコラム、5 番目のコラムの意味を、man procfs で調べよう

4 番目の 08:01 という文字列はデバイスを示すらしい。`メジャーデバイス番号:マイナーデバイス番号` という感じらしい。5 番目の 144225 は inode というものを示す。inode は、ファイルやディレクトリの、所有者や更新日時、ファイルサイズなどの「属性情報が書かれているデータ」。

man procfs
https://man7.org/linux/man-pages//man5/procfs.5.html

## Q49: 「アソシアティブキャッシュ」（associative cache; 連想キャッシュ）とは何か？TLB は、なぜそう呼ばれるのか？

調べてみたけど「連想キャッシュ」という言葉があまり一般的でない？のか、全然ヒットしない。アソシアティブ方式なる言葉がこれに該当するのであれば、キャッシュの多段性のようなことを指している言葉だと思われる。TLB = translation-lookaside buffer。TLB は物理メモリへのアクセスを考えた際に、ページテーブルにとってのキャッシュの役割を果たす。したがって、TLB もある意味で多段キャッシュだと言える。

## Q50: 仮想メモリの領域（region）とは？

仮想メモリは、主記憶を上位記憶とし、2 次記憶を下位記憶としたメモリ階層のシステムのこと。ユーザーはメモリ割付の仕事から解放される、複数ユーザー間でメモリ空間を共有することが可能になるなどの利点が生まれる。管理そのものはページ方式やセグメント方式で行われる。セグメント方式ではセグメント間に断片が発生しやすい。そのため、ページ方式のほうが多く用いられる。

## Q51: プログラムの実行コードを、その実行中に書き換えようとしたら、どうなるか？

セグフォになる。OS によってそういった処理は kill される。

## Q52: 無効なアドレスとは？

メモリが割り当てられていないアドレス。ページテーブル内のページに割り当てられていないアドレス。そこにアクセスすると、セグフォになる。

## Q53: 正規アドレスとは？

https://www.bottomupcs.com/virtual_memory_is.xhtml

たとえば 64 ビット長のレジスタを使っているとすると、その 64 ビットをすべて使えということはない。全体のメモリスペースというのは 2 つのパーツに別れていて、上位と下位にわけられている。間は少し空いていて、その空いている部分は「不正な」アドレス（non-canonical address）と呼ばれる。上位と下位に分けられた正当なアドレスを「正規アドレス（canonical address）」と呼ぶ。

## Q54: 変換テーブルとは？

仮想アドレスを物理アドレスに変換する際に使用するマッピングテーブルのこと。

## Q55: ページフレームとは？

物理アドレス空間から割り当てられた仮想テーブルのスロットのこと。

## Q56: メモリ領域とは？

テキスト領域、静的領域、ヒープ領域、スタック領域 4 つを組合わせたもの。

## Q57: 仮想アドレス空間とは何か。物理アドレス空間との違いは？

仮想アドレス空間はアプリケーションから見えるアドレス空間のこと。物理アドレス空間は、ハードウェアに存在するメモリのデータをアクセスするのに使われる。

## Q58: TLB とは何か

直近で行われたアドレス変換を保存しておくキャッシュのこと。

## Q59: 仮想メモリが十分に高速なのはなぜか？

局所性と、局所性を利用した TLB などによってキャッシングしているから。

## Q60: アドレス空間は、どうやって切り替えるのか

## Q61: 仮想メモリにあるプロテクション機構とは

TLB の中の書き込みアクセスビットを使用してページへの書き込みを防止している。また、意図しないプロセスからの読み込みもできないようにしている。

## Q62: EXB ビットの役割

コードの実行（命令のフェッチ）を禁止するフラグ。
